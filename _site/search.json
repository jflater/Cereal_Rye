[
  {
    "objectID": "Manuscript_Walkthrough.html",
    "href": "Manuscript_Walkthrough.html",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "",
    "text": "Code\n# Load necessary packages\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(zoo)\nlibrary(conflicted)\nlibrary(lme4)\nlibrary(emmeans)\nlibrary(broom)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(stringr)\nlibrary(tidyr)\nlibrary(scales)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(car)\nlibrary(rstatix)\nlibrary(janitor)\n\nconflict_prefer(\"filter\", \"dplyr\")\nCode\n# --- Theme & Colors  ---\ntreatment_colors &lt;- c(\n  \"Corn\" = \"#fda500\",\n  \"Soy\" = \"#E9967A\",\n  \"Sorghum\" = \"#D2B48C\",\n  \"Sorghum + Rye\" = \"#8B4513\"\n)\n\ntheme_sabr &lt;- function(base_size = 14) {\n  theme_minimal(base_size = base_size) +\n    theme(\n      axis.title = element_text(size = base_size + 2),\n      axis.text = element_text(size = base_size),\n      axis.text.x = element_text(angle = 45, hjust = 1),\n      legend.title = element_text(size = base_size),\n      legend.text = element_text(size = base_size - 1),\n      strip.text = element_text(size = base_size + 2),\n      panel.background = element_rect(fill = \"white\", color = NA),\n      plot.background = element_rect(fill = \"white\", color = NA),\n      plot.title = element_blank()\n    )\n}"
  },
  {
    "objectID": "Manuscript_Walkthrough.html#figure-1",
    "href": "Manuscript_Walkthrough.html#figure-1",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Figure 1",
    "text": "Figure 1\n\n\nCode\nggplot(all_n_data, aes(x = Treatment, y = mean, fill = N_Type)) +\n  geom_col(position = position_dodge(0.8), color = \"black\") +\n  geom_errorbar(\n    aes(ymin = mean - se, ymax = mean + se),\n    position = position_dodge(0.8),\n    width = 0.2\n  ) +\n  facet_wrap(~ growing_season) +\n  scale_fill_manual(\n  values = c(\"N₂O Emissions\" = \"#d73027\", \"Nitrogen Leaching\" = \"#4575b4\"),  # Red = N2O, Blue = Drainage\n  labels = c(\"N₂O Emissions\" = expression(\"N\"[2]*\"O Emissions\"), \"Nitrate Leaching\" = \"Nitrate Leaching\"),\n  name = \"N Loss Pathway\"\n) +\n  labs(\n  y = bquote(\"Cumulative N Loss (kg N ha\"^{-1}*\")\"),\n  x = \"Treatment\",\n  fill = \"N Loss Pathway\"\n) +\n  theme_sabr() \n\n\n\n\n\n\n\n\n\nCode\nggsave(\"figures/Figure_1.tiff\",\n       width = 180, height = 130, units = \"mm\", dpi = 600, compression = \"lzw\")\nggsave(\"figures/Figure_1.pdf\", width = 7.1, height = 5.5)  # double-column width\n\n\n\n\nCode\n# Create a table for the data in Figure 1 by selecting the relevant columns\nfigure1_table &lt;- all_n_data %&gt;%\n  select(growing_season, Treatment, N_Type, mean, sd, n, se, ci_lower, ci_upper)\n\n# Display the table with a caption; adjust digits as needed\nkable(figure1_table, digits = 2, caption = \"Summary of Cumulative N Losses (Figure 1)\")\n\n\n\nSummary of Cumulative N Losses (Figure 1)\n\n\n\n\n\n\n\n\n\n\n\n\n\ngrowing_season\nTreatment\nN_Type\nmean\nsd\nn\nse\nci_lower\nci_upper\n\n\n\n\n2023\nCorn\nNitrogen Leaching\n8.93\n4.18\n4\n2.09\n2.28\n15.57\n\n\n2023\nSoy\nNitrogen Leaching\n2.72\n4.22\n3\n2.44\n-7.76\n13.21\n\n\n2023\nSorghum\nNitrogen Leaching\n3.44\n4.19\n4\n2.10\n-3.23\n10.12\n\n\n2023\nSorghum + Rye\nNitrogen Leaching\n0.29\n0.27\n4\n0.13\n-0.14\n0.71\n\n\n2024\nCorn\nNitrogen Leaching\n7.05\n4.10\n3\n2.37\n-3.14\n17.24\n\n\n2024\nSoy\nNitrogen Leaching\n20.44\n14.89\n4\n7.45\n-3.26\n44.14\n\n\n2024\nSorghum\nNitrogen Leaching\n4.59\n5.07\n4\n2.53\n-3.47\n12.66\n\n\n2024\nSorghum + Rye\nNitrogen Leaching\n0.51\n0.49\n4\n0.24\n-0.27\n1.28\n\n\n2023\nCorn\nN₂O Emissions\n1.36\n726.23\n8\n0.26\n0.75\n1.97\n\n\n2024\nCorn\nN₂O Emissions\n4.24\n4007.56\n6\n1.64\n0.04\n8.45\n\n\n2023\nSorghum\nN₂O Emissions\n1.01\n621.97\n8\n0.22\n0.49\n1.53\n\n\n2024\nSorghum\nN₂O Emissions\n1.71\n1296.53\n8\n0.46\n0.63\n2.79\n\n\n2023\nSorghum + Rye\nN₂O Emissions\n1.02\n660.56\n8\n0.23\n0.46\n1.57\n\n\n2024\nSorghum + Rye\nN₂O Emissions\n0.86\n505.28\n8\n0.18\n0.44\n1.29\n\n\n2023\nSoy\nN₂O Emissions\n1.40\n559.46\n6\n0.23\n0.81\n1.99\n\n\n2024\nSoy\nN₂O Emissions\n1.35\n1400.70\n8\n0.50\n0.18\n2.52"
  },
  {
    "objectID": "Manuscript_Walkthrough.html#figure-2",
    "href": "Manuscript_Walkthrough.html#figure-2",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Figure 2",
    "text": "Figure 2\n\n\nCode\n# Create a year column\nnitrate_data &lt;- cumulative_flow_data %&gt;%\n  dplyr::filter(\n    treatment %in% c(\"Sorghum\", \"Sorghum + Rye\"),\n    !is.na(approx_nitrate_mg_l)\n  ) %&gt;%\n  mutate(year = year(date)) %&gt;%\n  group_by(date, treatment, year) %&gt;%\n  summarise(\n    mean_nitrate = mean(approx_nitrate_mg_l, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# Plot without SE ribbon\nggplot(nitrate_data, aes(x = date, y = mean_nitrate, color = treatment)) +\n  geom_line(size = 1) +\n  scale_color_manual(values = c(\"Sorghum\" = \"#D2B48C\", \"Sorghum + Rye\" = \"#8B4513\")) +\n  facet_wrap(~ year, scales = \"free_x\") +\n  labs(\n    x = \"Date\",\n    y = expression(\"Inorganic-N Concentration (mg N L\"^{-1}*\")\"),\n    color = \"Treatment\"\n  ) +\n  theme_sabr() +\n  scale_color_manual(values = treatment_colors) \n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n\n\n\n\n\n\n\n\n\nCode\nggsave(\"figures/Figure_2.tiff\",\n       width = 180, height = 130, units = \"mm\", dpi = 600, compression = \"lzw\")\nggsave(\"figures/Figure_2.pdf\", width = 7.1, height = 5.5)"
  },
  {
    "objectID": "Manuscript_Walkthrough.html#figure-3",
    "href": "Manuscript_Walkthrough.html#figure-3",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Figure 3",
    "text": "Figure 3\n\n\nCode\n# --- Figure 3: Annual Nitrate-N Losses (Boxplots) ---\nsorghum_data &lt;- cumulative_flow_data %&gt;% dplyr::filter(treatment %in% c(\"Sorghum\", \"Sorghum + Rye\"))\nsorghum_max &lt;- sorghum_data %&gt;% \n  group_by(growing_season, plot) %&gt;% \n  summarize(\n    max_loss = max(cumulative_n_loss_mg, na.rm = TRUE),\n    treatment = first(treatment),\n    .groups = \"drop\"\n  ) %&gt;%\n  mutate(max_loss_kg_ha = (max_loss / 1e6) / 0.145)\np3 &lt;- ggplot(sorghum_max, aes(x = factor(growing_season), y = max_loss_kg_ha, fill = treatment)) +\n  geom_boxplot() +\n  labs(x = \"Growing Season\",\n       y = expression(\"Cumulative Inorganic-N Loss (kg N ha \"^{-1}*\")\"),\n       fill = \"Treatment\") +\n  theme_sabr() +\n  scale_fill_manual(values = treatment_colors)\nprint(p3)\n\n\n\n\n\n\n\n\n\nCode\nggsave(\"figures/Figure_3.tiff\", plot = p3, width = 180, height = 130, units = \"mm\", dpi = 600)\nggsave(\"figures/Figure_3.pdf\", plot = p3, width = 7.1, height = 5.5)"
  },
  {
    "objectID": "Manuscript_Walkthrough.html#figure-4",
    "href": "Manuscript_Walkthrough.html#figure-4",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Figure 4",
    "text": "Figure 4\n\n\nCode\n# --- Figure 4: Daily N₂O Flux with Fertilizer Events ---\nsummarize_flux &lt;- nitrous_oxide %&gt;%\n  dplyr::filter(Treatment %in% c(\"Sorghum\", \"Sorghum + Rye\")) %&gt;%\n  group_by(growing_season, year_month_day, Treatment) %&gt;%\n  summarize(mean_flux = mean(gnha_day_no_negative, na.rm = TRUE),\n            se_flux   = sd(gnha_day_no_negative, na.rm = TRUE) / sqrt(n()),\n            .groups = \"drop\") %&gt;%\n  ungroup() %&gt;%\n  mutate(Treatment = factor(Treatment, levels = c(\"Sorghum\", \"Sorghum + Rye\")))\nfert_events &lt;- data.frame(\n  growing_season = c(2023, 2024),\n  fertilizer_date = as.Date(c(\"2023-05-05\", \"2024-07-17\"))\n)\np4 &lt;- ggplot(summarize_flux, aes(x = year_month_day, y = mean_flux, color = Treatment)) +\n  geom_line(size = 1.2, alpha = 0.8) +\n  geom_point(size = 2, position = position_dodge(width = 0.5)) +\n  geom_errorbar(aes(ymin = mean_flux - se_flux, ymax = mean_flux + se_flux),\n                width = 0.2, alpha = 0.5, position = position_dodge(width = 0.5)) +\n  geom_vline(data = fert_events, \n             aes(xintercept = fertilizer_date, color = \"Fertilizer Date\"),\n             linetype = \"dashed\", alpha = 0.7, show.legend = TRUE) +\n  geom_label(data = fert_events, \n             inherit.aes = FALSE,\n             aes(x = fertilizer_date, y = 90,\n                 label = format(fertilizer_date, \"%d-%b-%Y\")),\n             size = 3, hjust = 0, vjust = 0.5, show.legend = FALSE) +\n  scale_x_date(date_breaks = \"4 week\", date_labels = \"%d-%b-%Y\") +\n  labs(x = \"Date\",\n       y = expression(\"Daily N\"[2]*\"O Flux (g N ha\"^\"-1\"*\")\"),\n       color = \"Legend\") +\n  theme_sabr() +\n  scale_color_manual(values = c(treatment_colors, \"Fertilizer Date\" = \"red\"))\nprint(p4)\n\n\n\n\n\n\n\n\n\nCode\nggsave(\"figures/Figure_4.tiff\", plot = p4, width = 180, height = 130, units = \"mm\", dpi = 600)\nggsave(\"figures/Figure_4.pdf\", plot = p4, width = 7.1, height = 5.5)"
  },
  {
    "objectID": "Manuscript_Walkthrough.html#figure-5",
    "href": "Manuscript_Walkthrough.html#figure-5",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Figure 5",
    "text": "Figure 5\n\n\nCode\n# --- Figure 5: Row vs. Interrow N₂O Emissions ---\nflux_comparison &lt;- df %&gt;% dplyr::filter(RowvsInterrow != \"Fertilizer_band\")\np5 &lt;- ggplot(flux_comparison, aes(x = year_month_day, y = gnha_day_no_negative, color = RowvsInterrow)) +\n  geom_jitter(size = 1, alpha = 0.8) +\n  labs(x = \"Date\",\n       y = expression(\"Daily N\"[2]*\"O Flux (g N ha\"^{-1}*\")\"),\n       title = \"Row vs. Interrow N₂O Emissions Over Time\") +\n  facet_wrap(growing_season ~ Treatment, scales = \"free_x\", nrow = 2) +\n  theme_sabr()\nprint(p5)\n\n\nWarning: Removed 15423 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nCode\nggsave(\"figures/Figure_5.tiff\", plot = p5, width = 180, height = 130, units = \"mm\", dpi = 600)\n\n\nWarning: Removed 15423 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\nCode\nggsave(\"figures/Figure_5.pdf\", plot = p5, width = 7.1, height = 5.5)\n\n\nWarning: Removed 15423 rows containing missing values or values outside the scale range\n(`geom_point()`)."
  },
  {
    "objectID": "Manuscript_Walkthrough.html#figure-6",
    "href": "Manuscript_Walkthrough.html#figure-6",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Figure 6",
    "text": "Figure 6\n\n\nCode\n# --- Figure 6: Spatial Snapshot (Heatmap) ---\nfinal_day_data &lt;- df %&gt;%\n  group_by(growing_season, Treatment, plot) %&gt;%\n  dplyr::filter(year_month_day == max(year_month_day)) %&gt;%\n  ungroup() %&gt;%\n  mutate(plot = as.numeric(plot),\n         x = ((plot - 1) %% 5) + 1,\n         y = 3 - floor((plot - 1) / 5),\n         label = Treatment)\nheatmap_plot &lt;- ggplot(final_day_data, aes(x = x, y = y, fill = cumulative_flux)) +\n  geom_tile(color = \"white\", width = 0.9, height = 0.9) +\n  geom_text(aes(label = label), size = 5, color = \"black\") +\n  scale_fill_viridis_c(option = \"plasma\", name = \"Cumulative Flux\") +\n  facet_wrap(~ growing_season, ncol = 1) +\n  labs(x = \"Plot Column\", y = \"Plot Row (from south to north)\") +\n  scale_x_continuous(breaks = NULL) +\n  scale_y_continuous(breaks = NULL) +\n  theme_sabr()\nprint(heatmap_plot)\n\n\n\n\n\n\n\n\n\nCode\nggsave(\"figures/Figure_6.tiff\", plot = heatmap_plot, width = 12, height = 8, dpi = 600)\nggsave(\"figures/Figure_6.pdf\", plot = heatmap_plot, width = 7.1, height = 5.5)"
  },
  {
    "objectID": "Manuscript_Walkthrough.html#figure-7",
    "href": "Manuscript_Walkthrough.html#figure-7",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Figure 7",
    "text": "Figure 7\n\n\nCode\ncorn_soy &lt;- all_n_data %&gt;% \n  filter(Treatment %in% c(\"Corn\", \"Soy\"))\n\nggplot(corn_soy, aes(x = Treatment, y = mean, fill = N_Type)) +\n  geom_col(position = position_dodge(0.8), color = \"black\") +\n  geom_errorbar(\n    aes(ymin = mean - se, ymax = mean + se),\n    position = position_dodge(0.8),\n    width = 0.2\n  ) +\n  facet_wrap(~ growing_season) +\n  scale_fill_manual(\n  values = c(\"N₂O Emissions\" = \"#d73027\", \"Nitrogen Leaching\" = \"#4575b4\"),  # Red = N2O, Blue = Drainage\n  labels = c(\"N₂O Emissions\" = expression(\"N\"[2]*\"O Emissions\"), \"Nitrate Leaching\" = \"Nitrate Leaching\"),\n  name = \"N Loss Pathway\"\n) +\n  labs(\n  y = bquote(\"Cumulative N Loss (kg N ha\"^{-1}*\")\"),\n  x = \"Treatment\",\n  fill = \"N Loss Pathway\"\n) +\n  theme_sabr() \n\n\n\n\n\n\n\n\n\nCode\nggsave(\"figures/Figure_7.tiff\",\n       width = 180, height = 130, units = \"mm\", dpi = 600, compression = \"lzw\")\nggsave(\"figures/Figure_7.pdf\", width = 7.1, height = 5.5)  # double-column width\n\n\n\n\nCode\ncorn_soy %&gt;% \n  kbl(digits = 2) %&gt;% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n\n\n\n\n\ngrowing_season\nTreatment\nN_Type\nmean\nsd\nn\nse\nt_crit\nci_lower\nci_upper\n\n\n\n\n2023\nCorn\nNitrogen Leaching\n8.93\n4.18\n4\n2.09\n3.18\n2.28\n15.57\n\n\n2023\nSoy\nNitrogen Leaching\n2.72\n4.22\n3\n2.44\n4.30\n-7.76\n13.21\n\n\n2024\nCorn\nNitrogen Leaching\n7.05\n4.10\n3\n2.37\n4.30\n-3.14\n17.24\n\n\n2024\nSoy\nNitrogen Leaching\n20.44\n14.89\n4\n7.45\n3.18\n-3.26\n44.14\n\n\n2023\nCorn\nN₂O Emissions\n1.36\n726.23\n8\n0.26\n2.36\n0.75\n1.97\n\n\n2024\nCorn\nN₂O Emissions\n4.24\n4007.56\n6\n1.64\n2.57\n0.04\n8.45\n\n\n2023\nSoy\nN₂O Emissions\n1.40\n559.46\n6\n0.23\n2.57\n0.81\n1.99\n\n\n2024\nSoy\nN₂O Emissions\n1.35\n1400.70\n8\n0.50\n2.36\n0.18\n2.52\n\n\n\n\n\n\n\n\n\nCode\nfinal_sorghum &lt;- df %&gt;% \n  group_by(plot, growing_season, Treatment) %&gt;%\n  dplyr::filter(year_month_day == max(year_month_day)) %&gt;%  # One value per plot\n  ungroup()\n\n\n\n\nCode\n# Make sure 'Treatment' is a factor\nfinal_sorghum &lt;- final_sorghum %&gt;% \n  mutate(Treatment = as.factor(Treatment),\n         growing_season = as.factor(growing_season))\n\n# ----- Exploratory Data Analysis -----\n\n# Boxplot to visualize the cumulative_flux across treatments\nggplot(final_sorghum, aes(x = Treatment, y = cumulative_flux)) +\n  geom_boxplot(outliers = F) +\n  geom_jitter(aes(color = growing_season, shape = RowvsInterrow)) +\n  theme_minimal() +\n  labs(x = \"Treatment\", \n       y = \"Cumulative Flux\") \n\n\n\n\n\n\n\n\n\n\n\nCode\n# ----- Assumption Testing -----\nfinal_sorghum$Treatment &lt;- factor(final_sorghum$Treatment, levels = c(\"Corn\", \"Soy\", \"Sorghum\", \"Sorghum + Rye\"))\n# 1. Normality Test: Shapiro-Wilk test for each treatment group\nnormality_results &lt;- final_sorghum %&gt;%\n  group_by(Treatment) %&gt;%\n  summarise(shapiro_p = shapiro.test(cumulative_flux)$p.value)\nprint(normality_results)\n\n\n# A tibble: 4 × 2\n  Treatment     shapiro_p\n  &lt;fct&gt;             &lt;dbl&gt;\n1 Corn           0.000229\n2 Soy            0.00139 \n3 Sorghum        0.00769 \n4 Sorghum + Rye  0.0281  \n\n\nCode\n# Look for p &gt; 0.05 in each group to consider normality acceptable.\n# But be cautious: with n = 3-4, these tests are low power.\n\n# 2. Homogeneity of Variance: Levene's test\nlevene_result &lt;- leveneTest(cumulative_flux ~ Treatment, data = final_sorghum)\nprint(levene_result)\n\n\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value  Pr(&gt;F)  \ngroup  3   2.392 0.07816 .\n      56                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nCode\n# A non-significant result (p &gt; 0.05) suggests equal variances across groups.\n\nkrusk.test &lt;- final_sorghum %&gt;%\n  group_by(growing_season) %&gt;%\n  kruskal_test(cumulative_flux ~ Treatment)\nprint(krusk.test)\n\n\n# A tibble: 2 × 7\n  growing_season .y.                 n statistic    df     p method        \n* &lt;fct&gt;          &lt;chr&gt;           &lt;int&gt;     &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;         \n1 2023           cumulative_flux    30      3.55     3 0.314 Kruskal-Wallis\n2 2024           cumulative_flux    30      5.02     3 0.17  Kruskal-Wallis\n\n\nCode\nstat.test &lt;- final_sorghum %&gt;%\n  group_by(growing_season) %&gt;%\n  dunn_test(cumulative_flux ~ Treatment) %&gt;%\n  adjust_pvalue(method = \"bonferroni\") \nprint(stat.test)\n\n\n# A tibble: 12 × 10\n   growing_season .y.           group1 group2    n1    n2 statistic      p p.adj\n   &lt;fct&gt;          &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;\n 1 2023           cumulative_f… Corn   Soy        8     6    0.228  0.820  1    \n 2 2023           cumulative_f… Corn   Sorgh…     8     8   -1.28   0.201  1    \n 3 2023           cumulative_f… Corn   Sorgh…     8     8   -1.25   0.211  1    \n 4 2023           cumulative_f… Soy    Sorgh…     6     8   -1.41   0.158  1    \n 5 2023           cumulative_f… Soy    Sorgh…     6     8   -1.38   0.166  1    \n 6 2023           cumulative_f… Sorgh… Sorgh…     8     8    0.0284 0.977  1    \n 7 2024           cumulative_f… Corn   Soy        6     8   -1.61   0.107  1    \n 8 2024           cumulative_f… Corn   Sorgh…     6     8   -0.798  0.425  1    \n 9 2024           cumulative_f… Corn   Sorgh…     6     8   -2.06   0.0394 0.473\n10 2024           cumulative_f… Soy    Sorgh…     8     8    0.880  0.379  1    \n11 2024           cumulative_f… Soy    Sorgh…     8     8   -0.483  0.629  1    \n12 2024           cumulative_f… Sorgh… Sorgh…     8     8   -1.36   0.173  1    \n# ℹ 1 more variable: p.adj.signif &lt;chr&gt;\n\n\nCode\np &lt;- ggplot(final_sorghum, aes(x = Treatment, y = cumulative_flux, fill = Treatment)) + \n  geom_boxplot() +\n  labs(x = \"Treatment\", y = expression(\"Cumulative N\"[2]*\"O Flux (g N ha\"^\"-1\"*\")\")) +\n  facet_wrap( ~ growing_season) +\n  theme_sabr() +\n  scale_fill_manual(values = treatment_colors)\np\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Create drainage summary stats (if not already done)\ndrainage_summary_stats &lt;- bind_rows(drainage_summary_23, drainage_summary_24) %&gt;%\n  mutate(\n    cumulative_n_loss_kg_ha = (cumulative_n_loss_mg / 1e6) / 0.145,\n    N_Type = \"Nitrogen Leaching\",\n    Treatment = factor(treatment,\n                       levels = c(\"Corn\",\n                                  \"Soy\",\n                                  \"Sorghum\",\n                                  \"Sorghum + Rye\"))\n    )\n\nkrusk.test &lt;- drainage_summary_stats %&gt;%\n  group_by(growing_season) %&gt;%\n  kruskal_test(cumulative_n_loss_kg_ha ~ Treatment) %&gt;%\n  kable(\"html\", caption = \"Draiange Satistics (Kruskal Test),\n        N loss in kg/ha\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE) %&gt;%\n  scroll_box(width = \"100%\", height = \"500px\")\nkrusk.test\n\n\n\n\nDraiange Satistics (Kruskal Test), N loss in kg/ha\n\n\ngrowing_season\n.y.\nn\nstatistic\ndf\np\nmethod\n\n\n\n\n2023\ncumulative_n_loss_kg_ha\n15\n6.1125\n3\n0.1060\nKruskal-Wallis\n\n\n2024\ncumulative_n_loss_kg_ha\n15\n9.2875\n3\n0.0257\nKruskal-Wallis\n\n\n\n\n\n\n\nCode\nstat.test &lt;- drainage_summary_stats%&gt;%\n  group_by(growing_season) %&gt;%\n  dunn_test(cumulative_n_loss_kg_ha ~ Treatment) %&gt;%\n  adjust_pvalue(method = \"bonferroni\") %&gt;%\n  kable(\"html\", caption = \"Draiange Satistics (Dunn Test), N loss in kg/ha\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE) %&gt;%\n  scroll_box(width = \"100%\", height = \"500px\")\nstat.test\n\n\n\n\nDraiange Satistics (Dunn Test), N loss in kg/ha\n\n\ngrowing_season\n.y.\ngroup1\ngroup2\nn1\nn2\nstatistic\np\np.adj\np.adj.signif\n\n\n\n\n2023\ncumulative_n_loss_kg_ha\nCorn\nSoy\n4\n3\n-1.6102351\n0.1073465\n1.0000000\nns\n\n\n2023\ncumulative_n_loss_kg_ha\nCorn\nSorghum\n4\n4\n-1.6601958\n0.0968751\n1.0000000\nns\n\n\n2023\ncumulative_n_loss_kg_ha\nCorn\nSorghum + Rye\n4\n4\n-2.3717082\n0.0177061\n0.2124728\nns\n\n\n2023\ncumulative_n_loss_kg_ha\nSoy\nSorghum\n3\n4\n0.0731925\n0.9416529\n1.0000000\nns\n\n\n2023\ncumulative_n_loss_kg_ha\nSoy\nSorghum + Rye\n3\n4\n-0.5855400\n0.5581846\n1.0000000\nns\n\n\n2023\ncumulative_n_loss_kg_ha\nSorghum\nSorghum + Rye\n4\n4\n-0.7115125\n0.4767667\n1.0000000\nns\n\n\n2024\ncumulative_n_loss_kg_ha\nCorn\nSoy\n3\n4\n1.0978876\n0.2722536\n1.0000000\nns\n\n\n2024\ncumulative_n_loss_kg_ha\nCorn\nSorghum\n3\n4\n-0.5123475\n0.6084078\n1.0000000\nns\n\n\n2024\ncumulative_n_loss_kg_ha\nCorn\nSorghum + Rye\n3\n4\n-1.6834276\n0.0922923\n1.0000000\nns\n\n\n2024\ncumulative_n_loss_kg_ha\nSoy\nSorghum\n4\n4\n-1.7392527\n0.0819903\n0.9838839\nns\n\n\n2024\ncumulative_n_loss_kg_ha\nSoy\nSorghum + Rye\n4\n4\n-3.0041638\n0.0026631\n0.0319574\n*\n\n\n2024\ncumulative_n_loss_kg_ha\nSorghum\nSorghum + Rye\n4\n4\n-1.2649111\n0.2059032\n1.0000000\nns\n\n\n\n\n\n\n\nCode\np &lt;- ggplot(drainage_summary_stats, aes(x = Treatment, y = cumulative_n_loss_kg_ha, fill = Treatment)) + \n  geom_boxplot() +\n  labs(x = \"Treatment\", y = expression(\"Cumulative inorganic N (kg N ha\"^\"-1\"*\")\")) +\n  facet_wrap( ~ growing_season) +\n  theme_sabr() +\n  scale_fill_manual(values = treatment_colors)\n\n\n\nRye percent reduction\n\n\nCode\nreduction &lt;- drainage_summary_stats %&gt;% \n  group_by(growing_season, Treatment) %&gt;%\n  summarise(\n    mean_cumulative_n_loss = mean(cumulative_n_loss_kg_ha, na.rm = TRUE),\n    .groups = \"drop\"\n  )\nreduction %&gt;% \n  kbl(digits = 2) %&gt;% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n\n\n\n\n\ngrowing_season\nTreatment\nmean_cumulative_n_loss\n\n\n\n\n2023\nCorn\n8.93\n\n\n2023\nSoy\n2.72\n\n\n2023\nSorghum\n3.44\n\n\n2023\nSorghum + Rye\n0.29\n\n\n2024\nCorn\n7.05\n\n\n2024\nSoy\n20.44\n\n\n2024\nSorghum\n4.59\n\n\n2024\nSorghum + Rye\n0.51\n\n\n\n\n\n\n\nCode\nreduction_comp &lt;- reduction %&gt;%\n  dplyr::filter(Treatment %in% c(\"Sorghum\", \"Sorghum + Rye\")) %&gt;%\n  pivot_wider(names_from = Treatment, values_from = mean_cumulative_n_loss) %&gt;%\n  mutate(\n    reduction_abs = Sorghum - `Sorghum + Rye`,\n    reduction_perc = (reduction_abs / Sorghum) * 100\n  ) \nreduction_comp %&gt;% \n  kbl(digits = 2) %&gt;% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n\n\n\n\n\ngrowing_season\nSorghum\nSorghum + Rye\nreduction_abs\nreduction_perc\n\n\n\n\n2023\n3.44\n0.29\n3.15\n91.60\n\n\n2024\n4.59\n0.51\n4.09\n88.98"
  },
  {
    "objectID": "Manuscript_Walkthrough.html#table-1",
    "href": "Manuscript_Walkthrough.html#table-1",
    "title": "Impact of cereal rye cover crop on nitrogen losses from sorghum bioenergy in Central Iowa",
    "section": "Table 1",
    "text": "Table 1\n\n\nCode\nmy_table &lt;- all_n_data %&gt;% \n select(`Growing Season` = growing_season, `N Loss Pathway` = N_Type, Treatment, Mean = mean,\n        sd, n, se, `ci upper` = ci_upper, `ci lower` = ci_lower) %&gt;%\n  kbl(digits = 2)  %&gt;%\n  row_spec(9:16, bold = F, background = \"#b4b4b4\") %&gt;% \n  row_spec(1:8, bold = F, background = \"#c9c9c9\") %&gt;% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n\nmy_table\n\n\n\n\n\nGrowing Season\nN Loss Pathway\nTreatment\nMean\nsd\nn\nse\nci upper\nci lower\n\n\n\n\n2023\nNitrogen Leaching\nCorn\n8.93\n4.18\n4\n2.09\n15.57\n2.28\n\n\n2023\nNitrogen Leaching\nSoy\n2.72\n4.22\n3\n2.44\n13.21\n-7.76\n\n\n2023\nNitrogen Leaching\nSorghum\n3.44\n4.19\n4\n2.10\n10.12\n-3.23\n\n\n2023\nNitrogen Leaching\nSorghum + Rye\n0.29\n0.27\n4\n0.13\n0.71\n-0.14\n\n\n2024\nNitrogen Leaching\nCorn\n7.05\n4.10\n3\n2.37\n17.24\n-3.14\n\n\n2024\nNitrogen Leaching\nSoy\n20.44\n14.89\n4\n7.45\n44.14\n-3.26\n\n\n2024\nNitrogen Leaching\nSorghum\n4.59\n5.07\n4\n2.53\n12.66\n-3.47\n\n\n2024\nNitrogen Leaching\nSorghum + Rye\n0.51\n0.49\n4\n0.24\n1.28\n-0.27\n\n\n2023\nN₂O Emissions\nCorn\n1.36\n726.23\n8\n0.26\n1.97\n0.75\n\n\n2024\nN₂O Emissions\nCorn\n4.24\n4007.56\n6\n1.64\n8.45\n0.04\n\n\n2023\nN₂O Emissions\nSorghum\n1.01\n621.97\n8\n0.22\n1.53\n0.49\n\n\n2024\nN₂O Emissions\nSorghum\n1.71\n1296.53\n8\n0.46\n2.79\n0.63\n\n\n2023\nN₂O Emissions\nSorghum + Rye\n1.02\n660.56\n8\n0.23\n1.57\n0.46\n\n\n2024\nN₂O Emissions\nSorghum + Rye\n0.86\n505.28\n8\n0.18\n1.29\n0.44\n\n\n2023\nN₂O Emissions\nSoy\n1.40\n559.46\n6\n0.23\n1.99\n0.81\n\n\n2024\nN₂O Emissions\nSoy\n1.35\n1400.70\n8\n0.50\n2.52\n0.18\n\n\n\n\n\n\n\n\n\nCode\nlibrary(officer)\n\n\nWarning: package 'officer' was built under R version 4.4.3\n\n\nCode\nlibrary(flextable)\n\n\nWarning: package 'flextable' was built under R version 4.4.3\n\n\nCode\nlibrary(dplyr)\nmy_table &lt;- all_n_data %&gt;% \n  mutate(growing_season = make_date(year = growing_season, month = 1, day = 1)) %&gt;% \n  select(`Growing Season` = growing_season, `N Loss Pathway` = N_Type, Treatment, Mean = mean,\n        sd, n, se, `ci upper` = ci_upper, `ci lower` = ci_lower)\npublish_table_word &lt;- function(data, caption, file_name, digits = 2) {\n  # Optionally, format numeric columns if needed:\n  data &lt;- data %&gt;% mutate_if(is.numeric, ~ round(., digits))\n  \n  # Create a flextable object.\n  ft &lt;- flextable(data)\n  ft &lt;- colformat_double(ft, digits = digits)\n  ft &lt;- set_caption(ft, caption = caption)\n  ft &lt;- autofit(ft)\n  ft &lt;- colformat_date(ft, j = \"`Growing Season`\", fmt_date = \"%Y\")\n  \n  # Create a Word document and add the table.\n  doc &lt;- read_docx()\n  doc &lt;- body_add_flextable(doc, value = ft)\n  \n  # Save the document.\n  print(doc, target = file_name)\n  message(\"Word table saved to: \", file_name)\n}\n\n# Example usage:\npublish_table_word(my_table, \"Cumulative N losses\", \"tables/publication_ready_table.docx\")\n\n\nWord table saved to: tables/publication_ready_table.docx"
  }
]